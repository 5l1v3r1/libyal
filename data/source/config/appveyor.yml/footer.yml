
build_script:
- ps: .\synclibs.ps1
- ps: .\autogen.ps1
- cmd: if [%TARGET%]==[vs2008] (
    msbuild msvscpp\${library_name}.sln /logger:"C:\Program Files\AppVeyor\BuildAgent\Appveyor.MSBuildLogger.dll" )
- cmd: if [%TARGET%]==[vs2010] (
    C:\Python27\python.exe ..\libyal\scripts\msvscpp-convert.py --to 2010 msvscpp\${library_name}.sln &&
    msbuild vs2010\${library_name}.sln /logger:"C:\Program Files\AppVeyor\BuildAgent\Appveyor.MSBuildLogger.dll" )
- cmd: if [%TARGET%]==[vs2012] (
    C:\Python27\python.exe ..\libyal\scripts\msvscpp-convert.py --to 2012 msvscpp\${library_name}.sln &&
    msbuild vs2012\${library_name}.sln /logger:"C:\Program Files\AppVeyor\BuildAgent\Appveyor.MSBuildLogger.dll" )
- cmd: if [%TARGET%]==[vs2013] (
    C:\Python27\python.exe ..\libyal\scripts\msvscpp-convert.py --to 2013 msvscpp\${library_name}.sln &&
    msbuild vs2013\${library_name}.sln /logger:"C:\Program Files\AppVeyor\BuildAgent\Appveyor.MSBuildLogger.dll" )
- cmd: if [%TARGET%]==[vs2015] (
    C:\Python27\python.exe ..\libyal\scripts\msvscpp-convert.py --to 2015 msvscpp\${library_name}.sln &&
    msbuild vs2015\${library_name}.sln /logger:"C:\Program Files\AppVeyor\BuildAgent\Appveyor.MSBuildLogger.dll" )
- cmd: if [%TARGET%]==[cygwin] (
    xcopy /q /s C:\projects\${library_name} C:\cygwin\home\appveyor\ &&
    C:\cygwin\bin\bash -e -l -c "cd ${library_name}" &&
    C:\cygwin\bin\bash -e -l -c "./synclibs.sh && ./autogen.sh" &&
    C:\cygwin\bin\bash -e -l -c "./runtests.sh" )
- cmd: if [%TARGET%]==[cygwin64] (
    xcopy /q /s C:\projects\${library_name} C:\cygwin64\home\appveyor\ &&
    C:\cygwin64\bin\bash -e -l -c "cd ${library_name}" &&
    C:\cygwin64\bin\bash -e -l -c "./synclibs.sh && ./autogen.sh" &&
    C:\cygwin64\bin\bash -e -l -c "./runtests.sh" )
- cmd: if [%TARGET%]==[mingw] (
    xcopy /q /s C:\projects\${library_name} C:\MinGW\msys\1.0\home\appveyor\ &&
    C:\MinGW\msys\1.0\bin\bash -e -l -c "cd ${library_name}" &&
    C:\MinGW\msys\1.0\bin\bash -e -l -c "./synclibs.sh && ./autogen.sh" &&
    C:\MinGW\msys\1.0\bin\bash -e -l -c "./runtests.sh" )
- cmd: if [%TARGET%]==[mingw-w64] (
    xcopy /q /s C:\projects\${library_name} C:\msys64\home\appveyor\ &&
    C:\msys64\usr\bin\bash -e -l -c "cd ${library_name}" &&
    C:\msys64\usr\bin\bash -e -l -c "./synclibs.sh && ./autogen.sh" &&
    C:\msys64\usr\bin\bash -e -l -c "./runtests.sh" )

test_script:
- cmd: rem Run tests
- ps: if ($$env:TARGET -eq "vs2008") {
    .\runtests.ps1 }
- ps: if ($$env:TARGET -eq "vs2010") {
    .\runtests.ps1 }
- ps: if ($$env:TARGET -eq "vs2012") {
    .\runtests.ps1 }
- ps: if ($$env:TARGET -eq "vs2013") {
    .\runtests.ps1 }
- ps: if ($$env:TARGET -eq "vs2015") {
    .\runtests.ps1 }

